#N canvas 45 88 859 541 10;
#X obj 22 6 cnv 15 800 60 empty empty tis 20 12 0 14 -233017 -66577
0;
#N canvas 420 330 494 344 META 0;
#X text 12 45 LICENSE GPL v3;
#X text 12 178 RELEASE_DATE 2013;
#X text 12 158 WEBSITE https://sites.google.com/site/eargram/;
#X text 12 138 AUTHOR Gilberto Bernardes;
#X text 12 25 KEYWORDS;
#X text 12 118 LIBRARY earGram_abs;
#X text 12 65 DESCRIPTION plots geometric figures in a plan;
#X text 12 84 INLET_0 clear dimen point circle filledCircle square
filledSquare rectangle filled rectangle;
#X restore 789 495 pd META;
#X text 41 47 tonal interval space;
#X obj 70 237 nbx 5 14 -1e+37 1e+37 0 0 empty empty consonance 60 8
0 10 -262144 -1 -1 0.247435 256;
#X obj 105 216 nbx 5 14 -1e+37 1e+37 0 0 empty empty energy 60 8 0
10 -262144 -1 -1 7 256;
#X text 202 235 (0-1);
#X text 663 32 Gilberto Bernardes et al.;
#X text 759 47 INESC TEC;
#N canvas 775 417 505 357 pitch_relatadness 0;
#X floatatom 86 279 10 0 0 0 - - -;
#X floatatom 211 279 10 0 0 0 - - -;
#X msg 274 130 0 2 4 5 7 9 11;
#X obj 274 107 loadbang;
#X text 389 130 C major key;
#X floatatom 274 278 10 0 0 0 - - -;
#X obj 211 298 * 57.2958;
#X floatatom 211 320 10 0 0 0 - - -;
#X msg 86 80 0 4 7;
#X msg 96 100 5 9 0;
#X msg 106 120 7 11 2;
#X text 73 25 This subpatch provides a strategy to measure the relatedness
of a diatonic C major chords to the C major key. The results are provided
as Euclidean and angular distances.;
#X text 280 298 Cosine similarity (-1 to 1);
#X text 159 337 Angle in radians and angles;
#X text 56 297 Euclidean distance;
#X obj 86 237 list-euclid;
#X obj 274 156 midi2chroma;
#X obj 86 156 midi2chroma;
#X obj 274 190 tis symbolic;
#X obj 86 190 tis symbolic;
#X obj 211 237 list-cosine;
#X connect 1 0 6 0;
#X connect 2 0 16 0;
#X connect 3 0 2 0;
#X connect 6 0 7 0;
#X connect 8 0 17 0;
#X connect 9 0 17 0;
#X connect 10 0 17 0;
#X connect 15 0 0 0;
#X connect 16 0 18 0;
#X connect 17 0 19 0;
#X connect 18 0 15 1;
#X connect 18 0 20 1;
#X connect 19 0 15 0;
#X connect 19 0 20 0;
#X connect 20 0 1 0;
#X connect 20 1 5 0;
#X restore 534 413 pd pitch_relatadness;
#X text 530 249 You can use the abstractions [midi2chroma] and [midi2hpcp]
to convert between midi note values and chroma vectors reflecting symbolic
(binary) and (harmonic) audio spectra:, f 42;
#X msg 224 172 weights symbolic;
#X msg 224 152 weights audio;
#X obj 36 260 list prepend set;
#X obj 36 282 list trim;
#X msg 36 304 0.0191386 -0.0331503 0.0714274 0.123718 0.142856 3.66143e-07
-0.07143 0.123717 0.266569 0.461722 -0.142857 -9.41639e-06;
#X obj 533 325 midi2chroma-help;
#N canvas 146 170 855 553 harmonic_indicators_AUDIO 0;
#X obj 20 23 bng 15 250 50 0 empty empty empty 17 7 0 10 -260097 -1
-1;
#N canvas 394 23 563 270 opensample 0;
#X obj 11 40 openpanel;
#X obj 11 62 pack s \$0;
#X msg 11 84 read -resize \$1 \$2-sample;
#X obj 11 106 soundfiler;
#X obj 11 18 inlet;
#X obj 11 128 s \$0-fileDurInSamp;
#X obj 200 215 dac~;
#X obj 200 70 f;
#X obj 200 92 / 44.1;
#X obj 200 32 inlet;
#X obj 281 55 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X obj 200 183 tabread4~ \$0-sample;
#X msg 200 114 0 \, 1 \$1;
#X obj 200 136 line~;
#X obj 200 158 *~;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 5 0;
#X connect 3 0 7 1;
#X connect 3 0 14 1;
#X connect 4 0 0 0;
#X connect 7 0 8 0;
#X connect 8 0 12 0;
#X connect 9 0 7 0;
#X connect 10 0 7 0;
#X connect 11 0 6 0;
#X connect 11 0 6 1;
#X connect 12 0 13 0;
#X connect 13 0 14 0;
#X connect 14 0 11 0;
#X restore 20 44 pd opensample;
#N canvas 0 22 450 278 (subpatch) 0;
#X array \$0-sample 352800 float 2;
#X coords 0 1 352800 -1 800 140 2 0 0;
#X restore 15 161 graph;
#N canvas 580 23 675 583 analysis 0;
#X obj 39 147 until;
#X obj 39 169 f;
#X obj 71 169 + 1;
#X obj 39 193 t f f;
#X obj 53 41 r \$0-fileDurInSamp;
#X obj 101 152 0;
#X obj 22 58 f;
#X msg 22 537 normalize;
#X msg 272 127 resize \$1 \, const 0;
#X obj 39 241 pack f \$0;
#X obj 22 110 t b f b f;
#X obj 22 16 inlet;
#X obj 39 288 hpcp 20;
#X obj 272 273 loadbang;
#X msg 272 295 weights audio;
#X obj 272 150 s \$0-harmonicChange;
#X obj 66 470 tabwrite \$0-harmonicChange;
#X obj 22 559 s \$0-harmonicChange;
#N canvas 0 22 450 300 excludeSilence 0;
#X obj 18 26 inlet;
#X obj 98 26 inlet;
#X obj 18 65 spigot;
#X obj 98 70 sel 0;
#X obj 98 92 list;
#X obj 18 109 outlet;
#X obj 98 48 > 0.25;
#X connect 0 0 2 0;
#X connect 0 0 4 1;
#X connect 1 0 6 0;
#X connect 2 0 5 0;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 6 0 2 1;
#X connect 6 0 3 0;
#X restore 39 370 pd excludeSilence;
#X obj 39 392 t l l;
#X obj 333 409 - 1;
#X obj 66 448 expr if(isnan($f1)==0 \, $f1 \, 0);
#X msg 39 264 analyze \$1 8192 \$2-sample 44100;
#X obj 39 217 * 2048;
#X obj 22 83 expr int($f1/2048)-3;
#X obj 166 556 s \$0-consonance;
#X obj 392 332 tabwrite \$0-consonance;
#X obj 39 312 tis ---------;
#X obj 66 426 list-cosine;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 1 0 3 0;
#X connect 2 0 1 1;
#X connect 3 0 23 0;
#X connect 3 1 20 0;
#X connect 3 1 26 1;
#X connect 4 0 6 1;
#X connect 5 0 1 1;
#X connect 6 0 24 0;
#X connect 7 0 17 0;
#X connect 7 0 25 0;
#X connect 8 0 15 0;
#X connect 9 0 22 0;
#X connect 10 0 7 0;
#X connect 10 1 0 0;
#X connect 10 2 5 0;
#X connect 10 3 8 0;
#X connect 11 0 6 0;
#X connect 12 0 27 0;
#X connect 13 0 14 0;
#X connect 14 0 27 0;
#X connect 18 0 19 0;
#X connect 19 0 28 1;
#X connect 19 1 28 0;
#X connect 20 0 16 1;
#X connect 21 0 16 0;
#X connect 22 0 12 0;
#X connect 23 0 9 0;
#X connect 24 0 10 0;
#X connect 27 0 18 0;
#X connect 27 1 26 0;
#X connect 27 2 18 1;
#X connect 28 0 21 0;
#X restore 20 94 pd analysis;
#N canvas 0 22 450 278 (subpatch) 0;
#X array \$0-harmonicChange 169 float 0;
#X coords 0 1 168 0 800 70 2 0 0;
#X restore 15 331 graph;
#X obj 20 73 bng 15 250 50 0 empty empty empty 17 7 0 10 -260097 -1
-1;
#X text 418 19 early days piano;
#N canvas 0 22 450 278 (subpatch) 0;
#X array \$0-consonance 170 float 0;
#X coords 0 1 169 0 800 70 2 0 0;
#X restore 15 431 graph;
#X obj 108 23 bng 15 250 50 0 empty empty empty 17 7 0 10 -260097 -1
-1;
#X connect 0 0 1 0;
#X connect 5 0 3 0;
#X connect 8 0 1 1;
#X restore 534 440 pd harmonic_indicators_AUDIO;
#N canvas 0 172 552 431 harmonic_indicators_MIDI 0;
#N canvas 0 22 450 278 (subpatch) 0;
#X array \$0-harmonicChangeMIDI 58 float 3;
#A 0 1.5708 0.000345267 0.946044 1.46777 1.35654 0.723982 0.896609
1.35655 0.521222 1.85845 1.35654 1.35654 1.35654 0.532374 1.83455 0.870254
1.35654 0.524371 0.524371 1.17231 1.83456 0.52437 0.52437 0.53998 0.885076
0.586836 1.32139 0.532374 1.4897 0.000345267 1.35654 0.532374 1.56298
1.49864 0.489896 1.52569 0.532373 1.4897 1.43905 1.00969 1.88145 1.40984
1.49864 0.870254 1.35654 0.564864 1.41284 1.11934 1.42638 1.83781 1.83781
0.870254 0.53998 0.885076 0.586836 1.32139 0.532374 1.4897;
#X coords 0 3 58 0 500 70 1 0 0;
#X restore 22 129 graph;
#X msg 83 29 clear;
#N canvas 299 203 740 516 analysis 0;
#X obj 78 308 t l l;
#X obj 366 32 inlet;
#X obj 152 202 loadbang;
#X msg 152 224 weights symbolic;
#X obj 78 111 text get \$0-bwv253;
#X obj 529 26 text define -k \$0-bwv253;
#A set 45 69 64 73 \; 57 69 73 64 \; 57 69 74 64 \; 71 56 76 64 \;
69 73 57 64 \; 69 54 69 64 \; 69 54 69 62 \; 71 55 67 62 \; 71 55 66
62 \; 64 73 57 57 \; 74 50 57 66 \; 73 45 64 57 \; 71 52 56 64 \; 71
52 56 62 \; 69 57 54 61 \; 69 57 52 61 \; 50 66 62 69 \; 52 66 62 69
\; 54 66 62 69 \; 56 66 62 71 \; 64 57 61 73 \; 64 57 59 73 \; 73 64
57 49 \; 73 64 57 50 \; 52 57 64 71 \; 52 57 64 69 \; 56 64 71 52 \;
56 62 71 52 \; 45 52 61 69 \; 64 45 73 69 \; 68 52 64 71 \; 68 52 62
71 \; 73 53 68 61 \; 69 66 61 54 \; 69 64 61 54 \; 59 66 63 59 \; 59
66 63 57 \; 64 59 68 56 \; 64 54 57 69 \; 63 54 57 69 \; 64 52 71 56
\; 49 56 73 65 \; 54 61 57 69 \; 52 61 57 69 \; 62 66 69 54 \; 62 66
69 56 \; 64 69 61 57 \; 64 69 62 59 \; 69 66 57 61 \; 59 56 68 71 \;
54 73 57 69 \; 49 57 64 73 \; 50 57 64 73 \; 64 52 57 71 \; 64 52 57
69 \; 64 56 52 71 \; 62 56 52 71 \; 61 52 45 69 \;;
#X obj 78 66 f;
#X obj 104 66 + 1;
#X msg 190 49 0;
#X obj 78 36 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#N canvas 0 22 450 300 drip 0;
#X obj 63 84 t a a;
#X obj 63 241 spigot;
#X obj 102 149 bang;
#X obj 102 168 1;
#X obj 223 149 route bang;
#X obj 183 150 bang;
#X obj 183 169 0;
#X obj 102 114 list split 2;
#X obj 232 379 list split;
#X obj 299 328 list length;
#X obj 299 350 >> 1;
#X obj 63 260 t a a a a;
#X obj 63 446 list split;
#X obj 130 398 list length;
#X obj 130 423 >> 1;
#X obj 31 19 inlet;
#X obj 290 175 outlet;
#X text 73 19 Copyright 2009 by Mathieu Bouchard;
#X obj 31 53 t b a;
#X obj 465 119 outlet;
#X text 520 121 signal end of list;
#X text 381 23 made compatible with [list-drip]: fbar 2009;
#X connect 0 0 1 0;
#X connect 0 1 7 0;
#X connect 1 0 11 0;
#X connect 2 0 3 0;
#X connect 3 0 1 1;
#X connect 4 1 16 0;
#X connect 5 0 6 0;
#X connect 6 0 1 1;
#X connect 7 0 2 0;
#X connect 7 2 4 0;
#X connect 7 2 5 0;
#X connect 8 0 0 0;
#X connect 9 0 10 0;
#X connect 10 0 8 1;
#X connect 11 0 12 0;
#X connect 11 1 13 0;
#X connect 11 2 8 0;
#X connect 11 3 9 0;
#X connect 12 1 0 0;
#X connect 13 0 14 0;
#X connect 14 0 12 1;
#X connect 15 0 18 0;
#X connect 18 0 19 0;
#X connect 18 1 0 0;
#X restore 218 128 pd drip;
#X obj 218 151 makenote 64 500;
#X obj 218 173 noteout;
#X obj 78 10 inlet;
#X msg 366 57 const 0;
#X obj 382 102 s \$0-consonanceMIDI;
#X obj 78 88 t f f;
#X obj 366 82 s \$0-harmonicChangeMIDI;
#X obj 358 217 list prepend set;
#X obj 358 239 list trim;
#X obj 358 261 outlet;
#X obj 402 122 s \$0-dist2key;
#X obj 103 272 array set \$0-consonanceMIDI;
#X obj 105 362 array set \$0-harmonicChangeMIDI;
#X obj 315 362 array set \$0-dist2key;
#X obj 413 274 loadbang;
#X msg 413 296 0 1 1 0 1 0 1 0 1 1 0 1;
#X obj 78 160 midi2chroma;
#X obj 413 318 midi2chroma;
#X obj 78 241 tis -----;
#X obj 413 340 tis;
#X obj 105 338 list-cosine;
#X obj 315 335 list-cosine;
#X connect 0 0 31 1;
#X connect 0 1 31 0;
#X connect 1 0 8 0;
#X connect 1 0 14 0;
#X connect 2 0 3 0;
#X connect 3 0 29 0;
#X connect 4 0 10 0;
#X connect 4 0 18 0;
#X connect 4 0 27 0;
#X connect 6 0 7 0;
#X connect 6 0 16 0;
#X connect 7 0 6 1;
#X connect 8 0 6 1;
#X connect 9 0 6 0;
#X connect 10 0 11 0;
#X connect 11 0 12 0;
#X connect 11 1 12 1;
#X connect 13 0 9 0;
#X connect 14 0 15 0;
#X connect 14 0 17 0;
#X connect 14 0 21 0;
#X connect 16 0 4 0;
#X connect 16 1 22 1;
#X connect 16 1 23 1;
#X connect 16 1 24 1;
#X connect 18 0 19 0;
#X connect 19 0 20 0;
#X connect 25 0 26 0;
#X connect 26 0 28 0;
#X connect 27 0 29 0;
#X connect 28 0 30 0;
#X connect 29 0 0 0;
#X connect 29 0 32 0;
#X connect 29 1 22 0;
#X connect 30 0 32 1;
#X connect 31 0 23 0;
#X connect 32 0 24 0;
#X restore 20 52 pd analysis;
#N canvas 0 22 450 278 (subpatch) 0;
#X array \$0-consonanceMIDI 58 float 3;
#A 0 0.619584 0.619584 0.601668 0.619582 0.619584 0.583143 0.619583
0.619582 0.497641 0.619584 0.619583 0.619584 0.619582 0.483245 0.619584
0.619584 0.619583 0.49375 0.619583 0.483245 0.619584 0.493752 0.619584
0.472223 0.601668 0.767594 0.619582 0.483245 0.619584 0.619584 0.619582
0.483245 0.619582 0.619584 0.53124 0.619584 0.483247 0.619582 0.583143
0.567284 0.619582 0.619582 0.619584 0.619584 0.619583 0.417499 0.619584
0.519527 0.619584 0.734721 0.619584 0.619584 0.472223 0.601668 0.767594
0.619582 0.483245 0.619584;
#X coords 0 1 58 0 500 70 2 0 0;
#X restore 22 227 graph;
#X obj 20 29 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X msg 20 74 61 52 45 69;
#N canvas 0 22 450 278 (subpatch) 0;
#X array \$0-dist2key 58 float 3;
#A 0 1.21954 1.21954 1.83756 1.78004 1.21954 1.53681 1.87126 2.24452
2.2112 1.21954 1.87126 1.21954 1.78004 2.08521 1.2618 1.21954 1.87126
1.82964 1.87126 2.12994 1.21954 1.53303 1.21954 1.53131 1.83756 1.51269
1.78004 2.08521 1.21954 1.21954 1.78004 2.08521 1.1145 1.2618 1.27972
1.97398 1.93288 1.78004 1.53681 1.6412 1.78004 1.1145 1.2618 1.21954
1.87126 1.82243 1.21954 2.09537 1.2618 1.86825 1.2618 1.21954 1.53131
1.83756 1.51269 1.78004 2.08521 1.21954;
#X coords 0 3 58 0 500 70 2 0 0;
#X restore 22 327 graph;
#X connect 1 0 2 1;
#X connect 2 0 5 0;
#X connect 4 0 2 0;
#X restore 534 467 pd harmonic_indicators_MIDI;
#X obj 533 352 midi2hpcp-help;
#X text 222 102 Set weights (relative importance of complementary intervals
m2/M7 \, M2/m7 \, m3/M6 \, M3 \, m6 \, P4/P5 \, TT);
#X text 350 172 (default);
#X obj 11 395 list prepend set;
#X obj 11 417 list trim;
#X obj 36 137 midi2chroma;
#X obj 11 372 tis.mag;
#X msg 453 172 normalization \$1;
#X obj 453 150 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X text 580 171 Normalizes all TIVs to unity (default 1), f 23;
#N canvas 0 23 450 300 vectorNorm 0;
#X obj 262 172 0;
#X obj 182 53 inlet;
#X obj 166 271 outlet;
#X obj 166 216 f;
#N canvas 0 22 450 300 drip 0;
#X obj 63 84 t a a;
#X obj 63 241 spigot;
#X obj 102 149 bang;
#X obj 102 168 1;
#X obj 183 150 bang;
#X obj 183 169 0;
#X obj 102 114 list split 2;
#X obj 232 379 list split;
#X obj 299 328 list length;
#X obj 299 350 >> 1;
#X obj 63 260 t a a a a;
#X obj 63 446 list split;
#X obj 130 398 list length;
#X obj 130 423 >> 1;
#X obj 31 19 inlet;
#X obj 269 178 outlet;
#X text 73 19 Copyright 2009 by Mathieu Bouchard;
#X obj 31 53 t b a;
#X obj 465 119 outlet;
#X text 520 121 signal end of list;
#X text 381 23 made compatible with [list-drip]: fbar 2009;
#X obj 223 149 route bang float;
#X connect 0 0 1 0;
#X connect 0 1 6 0;
#X connect 1 0 10 0;
#X connect 2 0 3 0;
#X connect 3 0 1 1;
#X connect 4 0 5 0;
#X connect 5 0 1 1;
#X connect 6 0 2 0;
#X connect 6 2 4 0;
#X connect 6 2 21 0;
#X connect 7 0 0 0;
#X connect 8 0 9 0;
#X connect 9 0 7 1;
#X connect 10 0 11 0;
#X connect 10 1 12 0;
#X connect 10 2 7 0;
#X connect 10 3 8 0;
#X connect 11 1 0 0;
#X connect 12 0 13 0;
#X connect 13 0 11 1;
#X connect 14 0 17 0;
#X connect 17 0 18 0;
#X connect 17 1 0 0;
#X connect 21 1 15 0;
#X restore 182 104 pd drip;
#X obj 166 238 sqrt;
#X text 116 23 // vector norm (L2 norm);
#X obj 182 188 +;
#X obj 212 189 f;
#X obj 182 81 t l b;
#X obj 182 129 t f f;
#X obj 182 151 *;
#X connect 0 0 8 0;
#X connect 1 0 9 0;
#X connect 3 0 5 0;
#X connect 4 0 10 0;
#X connect 4 1 3 0;
#X connect 5 0 2 0;
#X connect 7 0 3 1;
#X connect 7 0 8 0;
#X connect 8 0 7 1;
#X connect 9 0 4 0;
#X connect 9 1 0 0;
#X connect 10 0 11 0;
#X connect 10 1 11 1;
#X connect 11 0 7 0;
#X restore 11 464 pd vectorNorm;
#X floatatom 11 485 5 0 0 0 - - -;
#X msg 11 439 0.0382783 0.142857 0.142856 0.142857 0.533147 0.142857
;
#X msg 36 113 0 \$1;
#X floatatom 36 92 5 0 0 0 - - -;
#X obj 36 188 tis symbolic;
#X msg 224 132 weights 1 1 1 1 1 1;
#X msg 86 86 0 2 4 5 7 9 11;
#X msg 194 80 0 2 4 7 9;
#X msg 271 79 0 2 4 5 7;
#X msg 321 358 power_spectrum 0 \, ordered 1;
#X connect 10 0 33 0;
#X connect 11 0 33 0;
#X connect 12 0 13 0;
#X connect 13 0 14 0;
#X connect 21 0 22 0;
#X connect 22 0 30 0;
#X connect 23 0 33 0;
#X connect 24 0 21 0;
#X connect 25 0 33 0;
#X connect 26 0 25 0;
#X connect 28 0 29 0;
#X connect 30 0 28 0;
#X connect 31 0 23 0;
#X connect 32 0 31 0;
#X connect 33 0 12 0;
#X connect 33 0 24 0;
#X connect 33 1 3 0;
#X connect 33 2 4 0;
#X connect 34 0 33 0;
#X connect 35 0 23 0;
#X connect 36 0 23 0;
#X connect 37 0 23 0;
#X connect 38 0 24 0;
